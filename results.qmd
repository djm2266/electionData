# Results
```{r}
joined_data <- read.csv('joined_data.csv')
joined_data
```


##Percentage Stacked Bar Chart of Election Votes

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
# Combine the data for House, Senate, and President elections
combined_data <- joined_data |>
  mutate(Election_Type = "House") |>
  select(state, year, Election_Type, DEMOCRAT_House, REPUBLICAN_House, LIBERTARIAN_House, OTHER_House) %>%
  rename(
    DEMOCRAT = DEMOCRAT_House,
    REPUBLICAN = REPUBLICAN_House,
    LIBERTARIAN = LIBERTARIAN_House,
    OTHER = OTHER_House
  ) |>
  bind_rows(
    joined_data |>
      mutate(Election_Type = "Senate") |>
      select(state, year, Election_Type, DEMOCRAT_Senate, REPUBLICAN_Senate, LIBERTARIAN_Senate, OTHER_Senate) |>
      rename(
        DEMOCRAT = DEMOCRAT_Senate,
        REPUBLICAN = REPUBLICAN_Senate,
        LIBERTARIAN = LIBERTARIAN_Senate,
        OTHER = OTHER_Senate
      ),
    joined_data |>
      mutate(Election_Type = "President") |> 
      select(state, year, Election_Type, DEMOCRAT_President, REPUBLICAN_President, LIBERTARIAN_President, OTHER_President) |>
      rename(
        DEMOCRAT = DEMOCRAT_President,
        REPUBLICAN = REPUBLICAN_President,
        LIBERTARIAN = LIBERTARIAN_President,
        OTHER = OTHER_President
      )
  ) |>
  pivot_longer(cols = c(DEMOCRAT, REPUBLICAN, LIBERTARIAN, OTHER),
               names_to = "Party", values_to = "Percent")

# Create the faceted bar chart
ggplot(combined_data, aes(x = factor(year), y = Percent, fill = Party)) +
  geom_bar(stat = "identity", position = "fill") +
  facet_wrap(~Election_Type, ncol = 1) +  
  scale_fill_manual(
    values = c(
      "DEMOCRAT" = "blue",
      "REPUBLICAN" = "red",
      "LIBERTARIAN" = "gold",
      "OTHER" = "gray"
    ),
    labels = c("Democrat", "Libertarian", "Other", "Republican")
  ) +
  labs(
    title = "Vote Percentages by Party Across Elections",
    x = "Year",
    y = "Percentage of Votes",
    fill = "Party"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```
```{r}
# Prepare the data
diverging_data <- joined_data %>%
  mutate(Election_Type = "House") %>%
  select(state, year, Election_Type, DEMOCRAT_House, REPUBLICAN_House) %>%
  rename(
    DEMOCRAT = DEMOCRAT_House,
    REPUBLICAN = REPUBLICAN_House
  ) %>%
  bind_rows(
    joined_data %>%
      mutate(Election_Type = "Senate") %>%
      select(state, year, Election_Type, DEMOCRAT_Senate, REPUBLICAN_Senate) %>%
      rename(
        DEMOCRAT = DEMOCRAT_Senate,
        REPUBLICAN = REPUBLICAN_Senate
      ),
    joined_data %>%
      mutate(Election_Type = "President") %>%
      select(state, year, Election_Type, DEMOCRAT_President, REPUBLICAN_President) %>%
      rename(
        DEMOCRAT = DEMOCRAT_President,
        REPUBLICAN = REPUBLICAN_President
      )
  ) %>%
  pivot_longer(cols = c(DEMOCRAT, REPUBLICAN), names_to = "Party", values_to = "Percent") %>%
  mutate(
    Percent = ifelse(Party == "DEMOCRAT", -Percent, Percent)  # Assign negative values for Democrats
  )

# Create the diverging stacked bar chart
ggplot(diverging_data, aes(x = factor(year), y = Percent, fill = Party)) +
  geom_bar(stat = "identity", position = "stack") +
  facet_wrap(~Election_Type, ncol = 1, scales = "free_y") +  # Allow free scaling for y-axis
  scale_fill_manual(
    values = c(
      "DEMOCRAT" = "blue",
      "REPUBLICAN" = "red"
    ),
    labels = c("Democrat", "Republican")
  ) +
  scale_y_continuous(labels = abs) +  # Display y-axis as absolute values
  labs(
    title = "Diverging Vote Percentages by Party Across Elections",
    x = "Year",
    y = "Percentage of Votes",
    fill = "Party"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    strip.text = element_text(size = 12),
    panel.spacing = unit(1.5, "lines")
  )

```

